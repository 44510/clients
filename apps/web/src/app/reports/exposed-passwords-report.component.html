<div class="page-header">
  <h1>{{ "exposedPasswordsReport" | i18n }}</h1>
</div>

<p>{{ "exposedPasswordsReportDesc" | i18n }}</p>

<bit-submit-button [loading]="loading" (click)="load()">
  {{ "checkExposedPasswords" | i18n }}
</bit-submit-button>

<div class="mt-4" *ngIf="hasLoaded">
  <app-callout type="success" title="{{ 'goodNews' | i18n }}" *ngIf="!ciphers.length">
    {{ "noExposedPasswords" | i18n }}
  </app-callout>

  <ng-container *ngIf="ciphers.length">
    <app-callout type="danger" title="{{ 'exposedPasswordsFound' | i18n }}" [useAlertRole]="true">
      {{ "exposedPasswordsFoundDesc" | i18n: (ciphers.length | number) }}
    </app-callout>

    <app-reports-result-list [ciphers]="ciphers">
      <ng-template let-c>
        <span bitBadge badgeType="warning">
          {{ "exposedXTimes" | i18n: (exposedPasswordMap.get(c.id) | number) }}
        </span>
      </ng-template>
    </app-reports-result-list>
  </ng-container>
</div>
